(this.webpackJsonplook=this.webpackJsonplook||[]).push([[0],{104:function(e,t,n){},155:function(e,t,n){},160:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(9),o=n.n(a),i=(n(104),n(90)),s=n(11),l=n(56),u=n(206),d=n(205),h=n(194),j=n(200),m=n(199),g=n(197),p=n(161),b=n(4),f=Object(h.a)((function(e){return{root:{"& > *":{margin:e.spacing(1)}},root2:{"& .MuiTextField-root":{margin:e.spacing(1),width:"25ch"}},root3:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}})),O=function(e){var t=f(),n=Object(c.useState)(null),r=Object(l.a)(n,2),a=r[0],o=r[1],i=Object(c.useState)([]),s=Object(l.a)(i,2),h=s[0],O=s[1];return Object(c.useEffect)((function(){var e=localStorage.getItem("photos");if(localStorage.getItem("photos")){e=JSON.parse(localStorage.getItem("photos")),console.log(e);var n=[];e.forEach((function(e){var c=e[0],r=e[1];n.push(Object(b.jsx)("div",{className:t.root3,children:Object(b.jsxs)(g.a,{container:!0,spacing:3,children:[Object(b.jsx)(g.a,{item:!0,xs:6,children:Object(b.jsxs)(p.a,{className:t.paper,children:[c.emoji,Object(b.jsxs)(m.a,{gutterBottom:!0,variant:"h5",component:"h2",children:[c.state," "]})]})}),Object(b.jsx)(g.a,{item:!0,xs:6,children:Object(b.jsxs)(p.a,{className:t.paper,children:[r.emoji,Object(b.jsxs)(m.a,{gutterBottom:!0,variant:"h5",component:"h2",children:[r.state," "]})]})})]})}))})),O(n)}else h.push(Object(b.jsx)("div",{children:" "}))}),[localStorage.getItem("photos")]),Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{className:t.root3,children:Object(b.jsxs)(g.a,{container:!0,spacing:4,children:[Object(b.jsx)(g.a,{item:!0,xs:3,children:Object(b.jsx)(j.a,{id:"createbtn",onClick:function(){var t=Object(u.a)();e.history.push("/room/".concat(t))},variant:"contained",color:"primary",children:"Create Room"})}),Object(b.jsxs)(g.a,{item:!0,xs:3,children:[Object(b.jsx)(d.a,{required:!0,id:"roomId",label:"Enter RoomId",defaultValue:"",onChange:function(e){return o(e.target.value)}}),Object(b.jsx)(j.a,{id:"joinbtn",onClick:function(){console.log(a),e.history.push("/room/".concat(a))},variant:"contained",color:"secondary",children:" Join ROOM"})]}),Object(b.jsx)(g.a,{item:!0,xs:3,children:Object(b.jsx)(j.a,{id:"hangbtn",variant:"contained",disabled:!0,children:" Hang Up "})})]})}),Object(b.jsx)("div",{children:h})]})},x=n(89),v=n.n(x),I=function(e){var t=500,n=500,c=localStorage.getItem("cam"),r=document.getElementById("video"),a=document.getElementById("partnerVideo"),o=document.getElementById("canvas"),i=document.getElementById("partnerCanvas"),s=(document.getElementById("photo"),document.getElementById("startbutton"),[]);function l(){var e=o.getContext("2d");e.fillStyle="#AAA",e.fillRect(0,0,o.width,o.height);o.toDataURL("image/png");var c=i.getContext("2d");c.fillStyle="#AAA",c.fillRect(0,0,o.width,o.height),function(){var e=o.getContext("2d"),c=i.getContext("2d");o.width=t,o.height=n,e.drawImage(r,0,0,t,n);var l=o.toDataURL("image/png");s.push(l),i.width=t,i.height=n,c.drawImage(a,0,0,t,n),l=i.toDataURL("image/png"),s.push(l)}()}return c&&null!=r&&(o.setAttribute("width",t),o.setAttribute("height",n),i.setAttribute("width",t),i.setAttribute("height",n)),null!==r&&l(),s},y=n(53),w=n.n(y),C=n(201),S=n(202),R=n(204),k=n(203),D=Object(h.a)({root:{maxWidth:345},media:{height:140}}),E=function(e){var t=D(),n=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(c.useRef)(),o=Object(c.useRef)(),i=Object(c.useRef)(),s=Object(c.useRef)(),l=[];function u(e){var t=new RTCPeerConnection({iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]});return t.onicecandidate=p,t.ontrack=O,t.onnegotiationneeded=function(){return function(e){a.current.createOffer().then((function(e){return a.current.setLocalDescription(e)})).then((function(){var t={target:e,caller:o.current.id,sdp:a.current.localDescription};o.current.emit("offer",t)})).catch((function(e){return console.log(e)}))}(e)},t}function d(e){a.current=u();var t=new RTCSessionDescription(e.sdp);a.current.setRemoteDescription(t).then((function(){s.current.getTracks().forEach((function(e){return a.current.addTrack(e,s.current)}))})).then((function(){return a.current.createAnswer()})).then((function(e){return a.current.setLocalDescription(e)})).then((function(){var t={target:e.caller,caller:o.current.id,sdp:a.current.localDescription};o.current.emit("answer",t)}))}function h(e){var t=new RTCSessionDescription(e.sdp);a.current.setRemoteDescription(t).catch((function(e){return console.log(e)}))}function p(e){if(e.candidate){var t={target:i.current,candidate:e.candidate};o.current.emit("ice-candidate",t)}}function f(e){var t=new RTCIceCandidate(e);a.current.addIceCandidate(t).catch((function(e){return console.log(e)}))}function O(e){r.current.srcObject=e.streams[0]}return Object(c.useEffect)((function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then((function(t){n.current.srcObject=t,s.current=t,localStorage.setItem("cam",!0),o.current=v.a.connect("/"),o.current.emit("join room",e.match.params.roomID),o.current.on("other user",(function(e){!function(e){a.current=u(e),s.current.getTracks().forEach((function(e){return a.current.addTrack(e,s.current)}))}(e),i.current=e})),o.current.on("user joined",(function(e){i.current=e})),o.current.on("offer",d),o.current.on("answer",h),o.current.on("ice-candidate",f)}))}),[]),Object(b.jsxs)(g.a,{container:!0,spacing:1,children:[Object(b.jsx)(g.a,{item:!0,xs:6,children:Object(b.jsxs)(C.a,{className:t.root,children:[Object(b.jsxs)(S.a,{children:[Object(b.jsx)("video",{id:"video",autoPlay:!0,ref:n,width:"100%",height:"100%"}),Object(b.jsxs)(k.a,{children:[Object(b.jsx)(m.a,{gutterBottom:!0,variant:"h5",component:"h2",children:"User"}),Object(b.jsxs)(m.a,{variant:"body2",color:"textSecondary",component:"p",children:["room Id : ",e.match.params.roomID]})]})]}),Object(b.jsxs)(R.a,{children:[Object(b.jsx)(j.a,{size:"small",variant:"contained",color:"primary",id:"startbutton",onClick:function(){if("undefined"!==n.current&&"indefined"!==r){var e=0;alert("moment capturing started!");var t=setInterval((function(){var n=I();console.log(n);var c={headers:{"Content-Type":"application/json;charset=UTF-8","Access-Control-Allow-Origin":"*"}},r="",a="",o={angry:"\ud83d\ude20",disgust:"\ud83e\udd22",fear:"\ud83d\ude31",happy:"\ud83d\ude01",sad:"\u2639\ufe0f",surprise:"\ud83d\ude2e",neutral:"\ud83d\ude10"},i=[{state:"neutral",emoji:"\ud83d\ude10",baseurl:"photo[0]"},{state:"neutral",emoji:"\ud83d\ude10",baseurl:"photo[1]"}];w.a.post("http://139.59.45.17:4567/",{baseurl:n[0]},c).then((function(e){console.log(e),r=e.data,i[0].state=r.slice(0,r.length-3),i[0].emoji=o[i[0].state]})).catch((function(e){return console.log(e)})),w.a.post("http://139.59.45.17:4567/",{baseurl:n[1]},c).then((function(e){console.log(e),a=e.data,i[1].state=a.slice(0,a.length-3),i[1].emoji=o[i[1].state]})).catch((function(e){return console.log(e)})),l.push(i),e++;var s=localStorage.getItem("cam");7===e&&s&&clearInterval(t)}),6e4)}},children:"Start Capture Moments!"}),Object(b.jsx)(j.a,{size:"small",variant:"contained",color:"secondary",id:"hangbtn",onClick:function(){localStorage.setItem("cam",!1),document.getElementById("video").srcObject.getTracks().forEach((function(e){e.stop()})),null===!r.current&&r.current.srcObject.getTracks().forEach((function(e){return e.stop()})),null===!a.current&&a.current.close(),console.log("cam closed!!"),console.log(l),localStorage.setItem("photos",JSON.stringify(l)),setTimeout(e.history.push("/"),6e4)},children:"Hang Up"})]})]})}),Object(b.jsx)(g.a,{item:!0,xs:6,children:Object(b.jsx)(C.a,{className:t.root,children:Object(b.jsxs)(S.a,{children:[Object(b.jsx)("video",{id:"partnerVideo",autoPlay:!0,ref:r,width:"100%",height:"100%"}),Object(b.jsx)(k.a,{children:Object(b.jsx)(m.a,{gutterBottom:!0,variant:"h5",component:"h2",children:"Partner"})})]})})}),Object(b.jsx)(g.a,{item:!0,xs:12,children:[]})]})},T=(n(155),Object(h.a)((function(e){return{root:{flexGrow:1},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}})));var A=function(){var e=T();return Object(b.jsx)("div",{className:e.root,children:Object(b.jsxs)(g.a,{container:!0,spacing:3,children:[Object(b.jsx)(g.a,{item:!0,xs:12,children:Object(b.jsx)(p.a,{className:e.paper,children:Object(b.jsx)(m.a,{gutterBottom:!0,variant:"h3",component:"h2",children:"LOOK "})})}),Object(b.jsx)(g.a,{item:!0,xs:12,children:Object(b.jsx)(p.a,{className:e.paper,children:Object(b.jsx)(i.a,{children:Object(b.jsxs)(s.c,{children:[Object(b.jsx)(s.a,{path:"/",exact:!0,component:O}),Object(b.jsx)(s.a,{path:"/room/:roomID",component:E})]})})})}),Object(b.jsx)(g.a,{item:!0,xs:12,children:Object(b.jsxs)(p.a,{className:e.paper,children:[Object(b.jsx)(m.a,{gutterBottom:!0,variant:"h5",component:"h2",children:"recent captured moment! "}),Object(b.jsxs)("div",{id:"pictures",children:[Object(b.jsx)("img",{id:"photo"}),Object(b.jsx)("canvas",{id:"canvas",width:"320",height:"240"}),Object(b.jsx)("canvas",{id:"partnerCanvas",width:"320",height:"240"})]})]})})]})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,208)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))};o.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(A,{})}),document.getElementById("root")),B()}},[[160,1,2]]]);
//# sourceMappingURL=main.86c2814e.chunk.js.map